<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Edit candidate</title>
</head>
<body>
	<h1>Edit candidate</h1>

	<p id="debug">Debug here</p>
	
    <form id="candidateForm" onsubmit="return false;">
    	CandidateId: <input type="text" name="candidateid" id="form_candidateid"><br>
        Lastname: <input type="text" name="lastname" id="form_lastname"><br>
        Firstname: <input type="text" name="firstname" id="form_firstname"><br>
        Political party: <input type="text" name="politicalparty" id="form_politicalparty"><br>
        Home city: <input type="text" name="city" id="form_city"><br>
        Age: <input type="text" name="age" id="form_age"><br>
        Why: <input type="text" name="whyquestion" id="form_whyquestion"><br>
        What: <input type="text" name="improvequestion" id="form_improvequestion"><br>
        Profession: <input type="text" name="profession" id="form_profession"><br>
    </form>

	<button onclick="editCandidate();">Save new information</button>
	
    <button onclick="removeCandidate();">Remove candidate</button>
    
    <button id="indexBtn">Home page</button>

	<script>
	
	var btn = document.getElementById('indexBtn');
	btn.addEventListener('click', function() {
		 document.location.href = 'index.html';
	});
	
	function removeCandidate() {
		var del = document.getElementById("candidateForm").form_candidateid.value;
		var url="./vaalikonejparest/vaalikonejpaservice/poistaehdokas/" + del;
        
		var xhttp = new XMLHttpRequest();
		 
        xhttp.onreadystatechange = function() {
           if (this.readyState == 4 && this.status == 200) {
               document.getElementById("debug").innerHTML = this.responseText;
           }
       }; 

       xhttp.open("POST", url, true);
       xhttp.send();
       setTimeout(function(){
    	   show()
       }, 1000);

   }

	function editCandidate() {
   	 
    	var form=document.getElementById("candidateForm");
        var candidate = new Object();
        candidate.candidateId = form.form_candidateId.value;
        candidate.lastname = form.form_lastname.value;
        candidate.firstname = form.form_firstname.value;
        candidate.politicalParty = form.form_politicalparty.value;
        candidate.city = form.form_city.value;
        candidate.age = form.form_age.value;
        candidate.whyQuestion = form.form_whyquestion.value;
        candidate.improveQuestion= form.form_improvequestion.value;
        candidate.profession = form.form_profession.value;
 
        var jsonCandidate = JSON.stringify(candidate);
/*      document.getElementById("yksia").innerHTML = jsonElain;
        document.getElementById("yksib").innerHTML = JSON.stringify(jsonElain); */
 
        var xhttp = new XMLHttpRequest();
 
         xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                document.getElementById("ihavenoideawhatimdoing").innerHTML = this.responseText;
/*              document.getElementById("osina").innerHTML = "ID="
                        + palautettu.id + " koko=" + palautettu.paino
                        + " Rotu=" + palautettu.laji; */
            }
        }; 
 
        xhttp.open("POST", "./vaalikonejparest/vaalikonejpaservice/muokkaaehdokas", true);
        //      xhttp.setRequestHeader("Content-type","text/plain");
        xhttp.setRequestHeader("Content-type", "application/json");
        //      xmlhttp.setRequestHeader("Data-type","json");
        xhttp.send(jsonCandidate);
    }
		</script>

		
<table id="table">

</table>

<script>
function readAll(){
	var xhttp = new XMLHttpRequest();

     xhttp.onreadystatechange = function() {
		 if (this.readyState == 4 && this.status == 200) {
			 var returned = JSON.parse(this.responseText);
			 var z="";
			 for (i=0;i<returned.length;i++){
				 var returnTable=returned[i];
				 z=z+"<tr><td>"+returnTable.candidateId+"<td>"+returnTable.firstname+"<td>"+returnTable.lastname;
			 }
			document.getElementById("table").innerHTML = z;
			 
		 }
	 };

	xhttp.open("GET",
			"./vaalikonejparest/vaalikonejpaservice/etsiehdokkaat",
			true);
	//      xhttp.setRequestHeader("Content-type","text/plain");
	xhttp.setRequestHeader("Content-type", "application/json");
	//      xmlhttp.setRequestHeader("Data-type","json");
	xhttp.send();
	
}
readAll();
</script>
</body>
</html>