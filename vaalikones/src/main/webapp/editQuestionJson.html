<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Edit question</title>

<link rel="stylesheet" href="style.css">

<script src="https://code.jquery.com/jquery-3.4.1.min.js"
	integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
	crossorigin="anonymous">
	
	
</script>
</head>
<body>
<div id="container">
    <h1>Editing questions</h1>

    <p id="debug">Debug here</p>

    <form id="question-form" onsubmit="return false;">
        QuestionId: <input type="text" name="kid" id="form_questionId"><br>
        Edit question:<br>
        <textarea name="form_edit" rows="4" cols="50" id="form_question"
                  placeholder="Choose the question ID above, and edit it here"></textarea>
    </form>

    <button onclick="SendEditQuestion();">Save changes</button>

    <button onclick="SendRemoveQuestion();">Remove question</button>

    <button id="indexBtn">Home page</button>

    <table id="table">

    </table>
</div>
<script>

    var btn = document.getElementById('indexBtn');
    btn.addEventListener('click', function () {
        document.location.href = 'index.html';
    });

    //function readAll(){
    //	var xhttp = new XMLHttpRequest();
    //
    //     xhttp.onreadystatechange = function() {
    //		 if (this.readyState == 4 && this.status == 200) {
    //			 var returned = JSON.parse(this.responseText);
    //			 var z="";
    //			 for (i=0;i<returned.length;i++){
    //				 var returnedTable=returned[i];
    //				 z=z+"<tr><td>"+y.questionId+"<td>"+returnedTable.question;
    //			 }
    //			document.getElementById("table").innerHTML = z;
    //
    //		 }
    //	 };

    //	xhttp.open("GET",
    //			"./vaalikonejparest/vaalikonejpaservice/etsikysymykset",
    //			true);
    //      xhttp.setRequestHeader("Content-type","text/plain");
    //	xhttp.setRequestHeader("Content-type", "application/json");
    //      xmlhttp.setRequestHeader("Data-type","json");
    //	xhttp.send();

    //}
    //readAll();

    function SendEditQuestion() {
        let question = {};
        question.questionId = $('#form_questionId').val;
        question.question = $('#form_question')[0].value;

        $.post({
            url: "/rest/election-machine/ems/edit-question",
            data: JSON.stringify(question),
            dataType: 'json',
            contentType: 'application/json',
            success: function (row) {
                $('#success-text').html('Question was successfully edited!!!');
                console.log(row);
                // routine for emptying form
                //$('#form_lastname').val('');
            },
        });

//    var xhttp = new XMLHttpRequest();

//     xhttp.onreadystatechange = function() {
//        if (this.readyState == 4 && this.status == 200) {
//            document.getElementById("ihavenoideawhatimdoing").innerHTML = this.responseText;
        /*              document.getElementById("osina").innerHTML = "ID="
                            + palautettu.id + " koko=" + palautettu.paino
                            + " Rotu=" + palautettu.laji; */
//        }
//    };

//    xhttp.open("POST", "./vaalikonejparest/vaalikonejpaservice/muokkaakysymys", true);
        //      xhttp.setRequestHeader("Content-type","text/plain");
//    xhttp.setRequestHeader("Content-type", "application/json");
        //      xmlhttp.setRequestHeader("Data-type","json");
//    xhttp.send(jsonQuestion);
    }

    function SendRemoveQuestion(questionId) {
        $.ajax({
            url: "/rest/election-machine/ems/remove-question/" + questionId,
            type: "DELETE",
            success: function (row) {
                $('tr[data-question-id = ' + questionId + ']').remove();
            },
        });
    }
</script>
</body>
</html>