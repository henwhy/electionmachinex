<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ehdokkaan muokkaus</title>
</head>
<body>
	<h1>Muokkaa ehdokasta</h1>

	<p id="debug">Debug here</p>
	
    <form id="ehdokaslomake" onsubmit="return false;">
    	EhdokasId: <input type="text" name="eid" id="rehdokasid"><br>
        Sukunimi: <input type="text" name="suku" id="rsuku"><br>
        Etunimi: <input type="text" name="etu" id="retu"><br>
        Puolue: <input type="text" name="puol" id="rpuol"><br>
        Kotipaikkakunta: <input type="text" name="koti" id="rkoti"><br>
        Ikä: <input type="text" name="ika" id="rika"><br>
        Miksi: <input type="text" name="miks" id="rmiks"><br>
        Mitä: <input type="text" name="mita" id="rmita"><br>
        Ammatti: <input type="text" name="amma" id="ramma"><br>
    </form>

	<button onclick="muokkaaehdokas();">Tallenna uudet tiedot</button>
	
    <button onclick="poistaehdokas();">Poista ehdokas</button>
    
    <button id="indexBtn">Etusivulle</button>

	<script>
	
	var btn = document.getElementById('indexBtn');
	btn.addEventListener('click', function() {
		 document.location.href = 'index.html';
	});
	
	function poistaehdokas() {
		var del = document.getElementById("ehdokaslomake").eid.value;
		var url="./vaalikonejparest/vaalikonejpaservice/poistaehdokas/" + del;
        
		var xhttp = new XMLHttpRequest();
		 
        xhttp.onreadystatechange = function() {
           if (this.readyState == 4 && this.status == 200) {
               document.getElementById("debug").innerHTML = this.responseText;
           }
       }; 

       xhttp.open("POST", url, true);
       xhttp.send();
       setTimeout(function(){
    	   show()
       }, 1000);

   }

	function muokkaaehdokas() {
   	 
    	var lom=document.getElementById("ehdokaslomake");
        var ehdokas = new Object();
    	ehdokas.ehdokasId = lom.eid.value;
        ehdokas.sukunimi = lom.suku.value;
        ehdokas.etunimi = lom.etu.value;
        ehdokas.puolue = lom.puol.value;
        ehdokas.kotipaikkakunta = lom.koti.value;
        ehdokas.ika = lom.ika.value;
        ehdokas.miksiEduskuntaan = lom.miks.value;
        ehdokas.mitaAsioitaHaluatEdistaa= lom.mita.value;
        ehdokas.ammatti = lom.amma.value;
 
        var jsonEhdokas = JSON.stringify(ehdokas);
/*      document.getElementById("yksia").innerHTML = jsonElain;
        document.getElementById("yksib").innerHTML = JSON.stringify(jsonElain); */
 
        var xhttp = new XMLHttpRequest();
 
         xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                document.getElementById("yksiriista").innerHTML = this.responseText;
/*              document.getElementById("osina").innerHTML = "ID="
                        + palautettu.id + " koko=" + palautettu.paino
                        + " Rotu=" + palautettu.laji; */
            }
        }; 
 
        xhttp.open("POST", "./vaalikonejparest/vaalikonejpaservice/muokkaaehdokas", true);
        //      xhttp.setRequestHeader("Content-type","text/plain");
        xhttp.setRequestHeader("Content-type", "application/json");
        //      xmlhttp.setRequestHeader("Data-type","json");
        xhttp.send(jsonEhdokas);
    }
		</script>

		
<table id="taulukko">

</table>

<script>
function lueKaikki(){
	var xhttp = new XMLHttpRequest();

     xhttp.onreadystatechange = function() {
		 if (this.readyState == 4 && this.status == 200) {
			 var palautettu = JSON.parse(this.responseText);
			 var z="";
			 for (i=0;i<palautettu.length;i++){
				 var y=palautettu[i];
				 z=z+"<tr><td>"+y.ehdokasId+"<td>"+y.etunimi+"<td>"+y.sukunimi;
			 }
			document.getElementById("taulukko").innerHTML = z;
			 
		 }
	 };

	xhttp.open("GET",
			"./vaalikonejparest/vaalikonejpaservice/etsiehdokkaat",
			true);
	//      xhttp.setRequestHeader("Content-type","text/plain");
	xhttp.setRequestHeader("Content-type", "application/json");
	//      xmlhttp.setRequestHeader("Data-type","json");
	xhttp.send();
	
}
lueKaikki();
</script>
</body>
</html>