<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Add new candidate</title>
</head>
<!--
onload tapahtuu, kun koko sivu on ladattu, siis voidaan kutsua dokumentin lopussa olevaa funktiota
<body onload='luepenantaulujaksoittain();'>
-->
<body>
	<h1>Add new candidate</h1>
		<form id="candidateform" action="#" onsubmit="return false;">
			Lastname: <input type="text" name="lastname" id="form_lastname"><br>
			Firstname: <input type="text" name="firstname" id="form_firstname"><br>
			Political party: <input type="text" name="politicalparty" id="form_politicalparty"><br>
			City: <input type="text" name="city" id="form_city"><br>
			Age: <input type="text" name="age" id="form_age"><br> 
			Why: <input type="text" name="whyquestion" id="form_whyquestion"><br> 
			Improve: <input type="text" name="improvequestion" id="form_improvequestion"><br> 
			Profession: <input type="text" name="profession" id="form_profession"><br>
		</form>
		<button onclick="sendCandidate();">Save information</button>
		<button id="indexBtn">Home page</button>
</body>
<!--
Javascript voi sijaita html-sivulla missä tahansa, kunhan muistaa, että muuttujien/aliohjelmien tulee olle esiteltynä enne käyttöä
-->
<script>
	var btn = document.getElementById('indexBtn');
	btn.addEventListener('click', function() {
		document.location.href = 'index.html';
	});

	function getCandidate() {

		var xhttp = new XMLHttpRequest();
		/* var xhttp = new XDomainRequest(); */

		if ("withCredentials" in xhttp) {
			xhttp
					.open(
							"GET",
							"./vaalikonejparest/vaalikonejpaservice/addcandidate",
							true);
		} else if (typeof XDomainRequest != "undefined") {
			xhttp = new XDomainRequest();
			xhttp
					.open(
							"GET",
							"./vaalikonejparest/vaalikonejpaservice/addcandidate",
							true);
		}
		if (!xhttp) {
			alert('CORS not supported!');
			return;
		}

		xhttp.onload = function() {
			document.getElementById("uusin").innerHTML = this.responseText;
		};

		/*      xhttp.onreadystatechange = function() {
		 if (this.readyState == 4 && this.status == 200) {
		 document.getElementById("uusin").innerHTML = this.responseText;
		 }
		 }; */

		/* xhttp.withCredentials = true; */

		/* xhttp.open("GET", "http://127.0.0.1:8080/riistajparest/riistajpaservice/riista", true); */
		xhttp.send();

	}

	function sendcandidate() {

		var form = document.getElementById("candidateform")
		var candidate = new Object();
		candidate.lastname = form.form_lastname.value;
		candidate.firstname = form.form_firstname.value;
		candidate.politicalparty = form.form_politicalparty.value;
		candidate.city = form.form_city.value;
		candidate.age = form.form_age.value;
		candidate.whyQuestion = form.form_whyquestion.value;
		candidate.improveQuestion = form.form_improvequestion.value;
		candidate.profession = form.form_profession.value;

		var jsonCandidate = JSON.stringify(candidate);
		/*      document.getElementById("yksia").innerHTML = jsonElain;
		 document.getElementById("yksib").innerHTML = JSON.stringify(jsonElain); */

		var xhttp = new XMLHttpRequest();

		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				document.getElementById("debug").innerHTML = this.responseText;
				var returned = JSON.parse(this.responseText);
				/*              document.getElementById("osina").innerHTML = "ID="
				 + palautettu.id + " koko=" + palautettu.paino
				 + " Rotu=" + palautettu.laji; */
			}
		};

		xhttp.open("POST",
				"./vaalikonejparest/vaalikonejpaservice/lisaaehdokas", true);
		//      xhttp.setRequestHeader("Content-type","text/plain");
		xhttp.setRequestHeader("Content-type", "application/json");
		//      xmlhttp.setRequestHeader("Data-type","json");
		xhttp.send(jsonCandidate);

	}
</script>


</html>