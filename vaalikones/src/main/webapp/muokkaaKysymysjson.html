<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Kysymyksen muokkaus</title>
</head>
<body>
	<div id="container">
	<h1>Muokkaa kysymystä</h1>
	
	<p id="debug">Debug here</p>
	
	<form id="kysymyslomake" onsubmit="return false;">
		KysymysId: <input type="text" name="kid" id="rkysymysid"><br>
		Muokkaa kysymystä:<br> 
		<textarea name="kmuok" rows="4" cols="50" placeholder="Lisää kysymysid ylempään boksiin ja muokkaa kysymystäsi tässä"></textarea>
	</form>
	
	<button onclick="muokkaakys();">Tallenna muokkaus</button>
	
	<button onclick="poistakysymys();">Poista kysymys</button>
	
	<button id="indexBtn">Etusivulle</button>
	
<table id="taulukko">

</table>
</div>
<script>

var btn = document.getElementById('indexBtn');
btn.addEventListener('click', function() {
	 document.location.href = 'index.html';
});

function lueKaikki(){
	var xhttp = new XMLHttpRequest();

     xhttp.onreadystatechange = function() {
		 if (this.readyState == 4 && this.status == 200) {
			 var palautettu = JSON.parse(this.responseText);
			 var z="";
			 for (i=0;i<palautettu.length;i++){
				 var y=palautettu[i];
				 z=z+"<tr><td>"+y.kysymysId+"<td>"+y.kysymys;
			 }
			document.getElementById("taulukko").innerHTML = z;
			 
		 }
	 };

	xhttp.open("GET",
			"./vaalikonejparest/vaalikonejpaservice/etsikysymykset",
			true);
	//      xhttp.setRequestHeader("Content-type","text/plain");
	xhttp.setRequestHeader("Content-type", "application/json");
	//      xmlhttp.setRequestHeader("Data-type","json");
	xhttp.send();
	
}
lueKaikki();

function muokkaakys() {
  	 
	var lom=document.getElementById("kysymyslomake");
    var kysymys = new Object();
	kysymys.kysymysId = lom.kid.value;
    kysymys.kysymys = lom.kmuok.value;

    var jsonKysymys = JSON.stringify(kysymys);
/*      document.getElementById("yksia").innerHTML = jsonElain;
    document.getElementById("yksib").innerHTML = JSON.stringify(jsonElain); */

    var xhttp = new XMLHttpRequest();

     xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            document.getElementById("yksiriista").innerHTML = this.responseText;
/*              document.getElementById("osina").innerHTML = "ID="
                    + palautettu.id + " koko=" + palautettu.paino
                    + " Rotu=" + palautettu.laji; */
        }
    }; 

    xhttp.open("POST", "./vaalikonejparest/vaalikonejpaservice/muokkaakysymys", true);
    //      xhttp.setRequestHeader("Content-type","text/plain");
    xhttp.setRequestHeader("Content-type", "application/json");
    //      xmlhttp.setRequestHeader("Data-type","json");
    xhttp.send(jsonKysymys);
}

function poistakysymys() {
	var del = document.getElementById("kysymyslomake").kid.value;
	var url="./vaalikonejparest/vaalikonejpaservice/poistakysymys/" + del;
    
	var xhttp = new XMLHttpRequest();
	 
    xhttp.onreadystatechange = function() {
       if (this.readyState == 4 && this.status == 200) {
           document.getElementById("debug").innerHTML = this.responseText;
       }
   }; 

   xhttp.open("POST", url, true);
   xhttp.send();
   setTimeout(function(){
	   show()
   }, 1000);

}
</script>
</body>
</html>